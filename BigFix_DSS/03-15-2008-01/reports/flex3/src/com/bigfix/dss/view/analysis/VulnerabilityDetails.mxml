<?xml version="1.0" encoding="utf-8"?>
<mx:Panel title="Vulnerability Details"
	xmlns:mx="http://www.adobe.com/2006/mxml"
	width="100%" height="100%"
	verticalAlign="top" horizontalAlign="left"
	verticalScrollPolicy="off" horizontalScrollPolicy="off"
	creationComplete="init()"
	>
	<mx:Script><![CDATA[
		import com.bigfix.dss.view.general.Alert.AlertPopUp;
		import mx.controls.Alert;
		import mx.rpc.events.ResultEvent;
		import mx.rpc.events.FaultEvent;

		import com.bigfix.dss.util.DSS;
		import com.bigfix.dss.vo.SubjectDetailsVO;
		

		[Bindable]
		public var options:SubjectDetailsVO;

		private function init():void {
			DSS.svc("EditorService").get({ 'class': this.options.className, 'id': this.options.id }).onResult(this.resultHandler).onFault(this.faultHandler);
		}

		private function faultHandler(event:FaultEvent):void {
			AlertPopUp.error(event.message.toString(), "Service Fault");
		}

		private function resultHandler(event:ResultEvent):void {
			vulnName.text=event.result.name;
			publishDate.text=event.result.publish_date;
			cvssBaseScore.text=event.result.cvss_base_score;
			cvssEnvironmentalScore.text=event.result.cvss_environmental_score;
			cvssFinalScore.text=event.result.cvss_final_score;
			cvssTemporalScore.text=event.result.cvss_temporal_score;
			description.text=event.result.description;
			vulnSeverityId.text=event.result.vuln_severity_id;
		}
	]]></mx:Script>
	<mx:Panel title="Details" styleName="detailsContainer" width="100%">
		<mx:Grid width="100%" height="100%">
			<mx:GridRow width="100%" height="100%">
				<mx:GridItem width="10%" height="100%">
					<mx:Label text="Name:"/>
				</mx:GridItem>
				<mx:GridItem width="90%" height="100%">
					<mx:Text width="100%" id="vulnName"/>
				</mx:GridItem>
			</mx:GridRow>
			<mx:GridRow width="100%" height="100%">
				<mx:GridItem width="10%" height="100%">
					<mx:Label text="Vulnerability Severity Id:"/>
				</mx:GridItem>
				<mx:GridItem width="90%" height="100%">
					<mx:Text width="100%" id="vulnSeverityId"/>
				</mx:GridItem>
			</mx:GridRow>
			<mx:GridRow width="100%" height="100%">
				<mx:GridItem width="10%" height="100%">
					<mx:Label text="Publish Date:"/>
				</mx:GridItem>
				<mx:GridItem width="90%" height="100%">
					<mx:Text width="100%" id="publishDate"/>
				</mx:GridItem>
			</mx:GridRow>
			<mx:GridRow width="100%" height="100%">
				<mx:GridItem width="10%" height="100%">
					<mx:Label text="CVSS Base Score:"/>
				</mx:GridItem>
				<mx:GridItem width="90%" height="100%">
					<mx:Text width="100%" id="cvssBaseScore"/>
				</mx:GridItem>
			</mx:GridRow>
			<mx:GridRow width="100%" height="100%">
				<mx:GridItem width="10%" height="100%">
					<mx:Label text="CVSS Environmental Score:"/>
				</mx:GridItem>
				<mx:GridItem width="90%" height="100%">
					<mx:Text width="100%" id="cvssEnvironmentalScore"/>
				</mx:GridItem>
			</mx:GridRow>
			<mx:GridRow width="100%" height="100%">
				<mx:GridItem width="10%" height="100%">
					<mx:Label text="CVSS Final Score:"/>
				</mx:GridItem>
				<mx:GridItem width="90%" height="100%">
					<mx:Text width="100%" id="cvssFinalScore"/>
				</mx:GridItem>
			</mx:GridRow>
			<mx:GridRow width="100%" height="100%">
				<mx:GridItem width="10%" height="100%">
					<mx:Label text="CVSS Temporal Score:"/>
				</mx:GridItem>
				<mx:GridItem width="90%" height="100%">
					<mx:Text width="100%" id="cvssTemporalScore"/>
				</mx:GridItem>
			</mx:GridRow>
		</mx:Grid>
	</mx:Panel>
	<mx:Panel title="Description" styleName="detailsContainer" width="100%">
		<mx:Text id="description"/>
	</mx:Panel>
</mx:Panel>
